<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <title>æ­è†©é–‹é£¯å•¦éŸ“å¼é¤é¤¨</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fffaf0;
            color: #333;
        }
        header {
            background-color: #b22222;
            color: white;
            text-align: center;
            padding: 20px 10px;
        }
        header h1 {
            font-family: 'Playfair Display', serif;
            margin: 0;
            font-size: 36px;
        }
        header p {
            margin: 0;
            font-size: 18px;
        }
        /* å°è¦½åˆ—æ¨£å¼ */
        nav {
            background-color: #f1f1f1;
            padding: 10px 0;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        nav a {
            text-decoration: none;
            color: #b22222;
            font-weight: 700;
            margin: 0 15px;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        nav a:hover {
            background-color: #ddd;
        }
        
        /* main å€å¡Šå¢åŠ åº•éƒ¨é–“è·ï¼Œé˜²æ­¢å…§å®¹è¢«è³¼ç‰©è»Š Bar é®ä½ */
        main {
            padding: 20px;
            text-align: center;
            /* å¢åŠ åº•éƒ¨é‚Šè·ï¼Œç¢ºä¿ä¸æœƒè¢«è³¼ç‰©è»ŠBaré®æ“‹ */
            padding-bottom: 120px; 
        }

        h2 {
            font-size: 28px;
            color: #b22222;
            margin-top: 40px;
        }
        .menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        .dish {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 200px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .dish img {
            width: 100%;
            border-radius: 8px;
        }
        .dish h3 {
            margin: 10px 0 5px;
            font-size: 18px;
        }
        .dish p {
            font-size: 14px;
            color: #666;
        }
        .dish button {
            margin-top: 10px;
            padding: 8px 12px;
            background-color: #b22222;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* ************************************** */
        /* è³¼ç‰©è»Šæ¨£å¼ï¼šå›ºå®šåœ¨å³ä¸‹è§’ï¼Œé è¨­æ”¶åˆ */
        /* ************************************** */
        #cart {
            position: fixed;
            bottom: 0;           /* å›ºå®šåœ¨åº•éƒ¨ */
            right: 20px;         /* é å³é‚Š */
            width: 90%;          /* é è¨­å¯¬åº¦ (æ‰‹æ©Ÿ) */
            max-width: 400px;    /* æ¡Œé¢ç‰ˆæœ€å¤§å¯¬åº¦ */
            background-color: #fff;
            border: 1px solid #b22222; 
            padding: 10px;
            border-radius: 10px 10px 0 0; /* åº•éƒ¨ Bar åœ“è§’ */
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;      
            max-height: 50px;    /* é è¨­é«˜åº¦ç¸®å°ç‚ºä¸€å€‹ Bar */
            overflow: hidden;   
            /* éæ¸¡æ•ˆæœè®“å±•é–‹/æ”¶åˆæ›´å¹³æ»‘ */
            transition: max-height 0.3s ease-in-out, width 0.3s ease-in-out, bottom 0.3s ease-in-out; 
            text-align: left;
        }
        
        /* å±•é–‹è³¼ç‰©è»Šçš„æ¨£å¼ */
        #cart.expanded {
            max-height: 80vh; /* å±•é–‹æ™‚ä½”æ“šè¢å¹•ç´„ä¸€åŠé«˜åº¦ */
            width: 90%;
            max-width: 400px;
        }

        /* è³¼ç‰©è»Šæ¨™é¡Œ (é»æ“Š Bar) - åŒ…å«å³æ™‚ç¸½è¨ˆ */
        #cart h4 {
            margin: 0;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 20px;
            color: #b22222;
        }

        /* è³¼ç‰©è»Šåˆ—è¡¨ã€ç¸½è¨ˆå’ŒæŒ‰éˆ•çš„æ¨£å¼èª¿æ•´ */
        #cart-list, #total, #checkout-btn, #customer-info {
            display: none; /* é è¨­åœ¨æ”¶åˆç‹€æ…‹ä¸‹éš±è— */
        }
        
        /* åœ¨å±•é–‹ç‹€æ…‹ä¸‹é¡¯ç¤º */
        #cart.expanded #cart-list, #cart.expanded #total, #cart.expanded #checkout-btn, #cart.expanded #customer-info {
            display: block; 
        }

        /* é¡§å®¢è³‡è¨Šæ¬„ä½ */
        #customer-info input, #customer-info textarea {
            display: block;
            width: calc(100% - 12px); /* 100% æ¸›å» padding */
            padding: 5px;
            margin-bottom: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box; /* ç¢ºä¿ padding ä¸æœƒå¢åŠ å¯¬åº¦ */
        }
        #customer-info textarea {
            resize: vertical;
        }


        /* è³¼ç‰©è»Šåˆ—è¡¨çš„æ¨£å¼èª¿æ•´ */
        #cart-list {
            list-style-type: none;
            padding-left: 0;
            margin-top: 10px;
            max-height: calc(80vh - 180px); /* ç¢ºä¿åˆ—è¡¨åœ¨å±•é–‹ç‹€æ…‹ä¸‹å¯ä»¥æ²å‹•ï¼Œä¸¦ç‚ºè¡¨å–®ç•™å‡ºç©ºé–“ */
            overflow-y: auto;
        }
        #cart-list li {
            margin-bottom: 5px;
            border-bottom: 1px dashed #eee;
            padding-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        /* ************************************** */
        /* END è³¼ç‰©è»Šæ¨£å¼ */
        /* ************************************** */


        /* è³¼ç‰©è»Šçµå¸³æŒ‰éˆ•æ¨£å¼å„ªåŒ– */
        #checkout-btn {
            margin-top: 10px;
            padding: 10px; 
            background: linear-gradient(180deg, #228b22 0%, #1a6f1a 100%);
            color: white;
            border: none;
            width: 100%;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 0 #145614;
            transition: all 0.1s ease;
        }
        #checkout-btn:hover {
            background: linear-gradient(180deg, #28a028 0%, #1a6f1a 100%);
            box-shadow: 0 3px 0 #145614;
            transform: translateY(1px);
        }
        #checkout-btn:active {
            box-shadow: 0 0 0 #145614;
            transform: translateY(4px);
        }

        /* è¨‚ä½å€å¡Šæ¨£å¼ */
        #booking-section {
            margin-bottom: 40px; 
            padding: 40px 20px; 
            background-color: #fcecec; 
            border-radius: 10px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .booking-btn {
            display: inline-block; 
            padding: 15px 30px; 
            background-color: #228b22; 
            color: white; 
            text-decoration: none; 
            border-radius: 8px; 
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* çµå¸³ç•«é¢ Modal æ¨£å¼ (ç²¾ç·»åŒ–) */
        #checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
        }
        .modal-content {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 450px;
            text-align: left;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.4s ease-out;
            border: 3px solid #b22222;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-content h3 {
            color: #b22222;
            text-align: center;
            font-size: 26px;
            font-weight: 700;
            border-bottom: 3px double #b22222;
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .modal-content h4 {
            color: #333;
            font-size: 18px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
            margin-top: 25px;
        }
        #order-summary {
            list-style-type: none;
            padding: 0;
            margin-bottom: 20px;
            font-size: 15px;
        }
        #order-summary li {
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
        }
        #order-summary .item-name {
            flex: 2;
        }
        #order-summary .item-price {
            flex: 1;
            text-align: right;
            font-weight: 600;
        }
        #order-total {
            font-size: 24px;
            font-weight: bold;
            text-align: right;
            padding-top: 10px;
            border-top: 2px solid #b22222;
            color: #b22222;
        }
        
        /* ç¹¼çºŒé»é¤æŒ‰éˆ•æ¨£å¼å„ªåŒ– */
        #continue-btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 30px;
            background: linear-gradient(180deg, #b22222 0%, #8b1a1a 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 19px;
            font-weight: bold;
            box-shadow: 0 4px 0 #701414;
            transition: all 0.1s ease;
        }
        #continue-btn:hover {
            background: linear-gradient(180deg, #cc2727 0%, #8b1a1a 100%);
            box-shadow: 0 3px 0 #701414;
            transform: translateY(1px);
        }
        #continue-btn:active {
            box-shadow: 0 0 0 #701414;
            transform: translateY(4px);
        }

        /* Footer æ¨£å¼èª¿æ•´ä»¥æ‡‰å°åº•éƒ¨è³¼ç‰©è»Š */
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            /* èª¿æ•´ padding-bottom çµ¦è³¼ç‰©è»Šç•™å‡ºç©ºé–“ */
            padding: 10px 0 70px 0; 
            margin-top: 40px;
            font-size: 14px;
            position: relative;
            z-index: 1;
        }
    </style>
</head>
<body>
    <header>
        <h1>æ­è†©é–‹é£¯å•¦éŸ“å¼é¤é¤¨</h1>
        <p>å¸¶çµ¦æ‚¨æ­£å®—çš„éŸ“å¼ç¾é£Ÿé«”é©—</p>
    </header>

    <nav>
        <a href="#booking-section">ğŸ“ ç·šä¸Šè¨‚ä½</a>
        <a href="#menu-list">ğŸœ é»é¤èœå–®</a>
        <a href="#cart-location">ğŸ›’ è³¼ç‰©è»Š</a>
    </nav>

    <div id="cart" onclick="toggleCart()">
        <a id="cart-location" style="visibility: hidden; position: absolute; top: -50px;"></a>
        
        <h4>
            <span>è³¼ç‰©è»Š ğŸ›’</span>
            <span id="cart-summary-text"> (ç¸½è¨ˆï¼š$0) </span>
        </h4>

        <div id="customer-info" style="margin-top: 10px;">
            <input type="text" id="customer-name" placeholder="æ‚¨çš„å§“å (å¿…å¡«)" required>
            <textarea id="order-remarks" placeholder="è¨‚å–®å‚™è¨» (ä¾‹å¦‚ï¼šå°‘å†°ã€ä¸åŠ é¦™èœ)" rows="2"></textarea>
        </div>
        
        <ul id="cart-list">
            </ul>
        <p id="total">ç¸½è¨ˆï¼š$0</p>
        <button id="checkout-btn" onclick="event.stopPropagation(); checkout();">ç«‹å³çµå¸³</button> 
    </div>

    <main id="menu-container">
        <section id="booking-section">
            <h2>ğŸ“ ç·šä¸Šè¨‚ä½ </h2>
            <p>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ• æŸ¥çœ‹å³æ™‚ç©ºä½ä¸¦é€²è¡Œé ç´„ã€‚</p>
            
            <a href="https://calendly.com/anita-chen0201/meet-with-me" target="_blank" class="booking-btn">
                æŸ¥çœ‹å³æ™‚ç©ºä½ä¸¦é ç´„
            </a>
            
            <p style="margin-top: 15px; font-size: 14px; color: #b22222;">(å°‡å°å‘æ‚¨çš„ Calendly é ç´„é é¢)</p>
        </section>

        <div id="menu-list"></div>
    </main>

    <footer>
        <p>åœ°å€ï¼šæ–°åŒ—å¸‚æ·¡æ°´å€æ–°æ°‘è¡—180å··123è™Ÿ1æ¨“</p>
        <p>è¯çµ¡æˆ‘å€‘ï¼šanita.chen0201@gmail.com</p>
    </footer>

    <div id="checkout-modal">
        <div class="modal-content">
            <h3>æ„Ÿè¬æ‚¨çš„è¨‚è³¼ï¼</h3>
            <p style="text-align: center; font-style: italic; color: #666;">æˆ‘å€‘å·²å°‡è¨‚å–®é€å‡ºï¼Œç¨å¾Œç‚ºæ‚¨æº–å‚™ã€‚</p>
            <hr>
            <div id="modal-customer-info"></div>
            
            <h4>è¨‚å–®æ‘˜è¦ï¼š</h4>
            <ul id="order-summary"></ul>
            <p id="order-total">æœ€çµ‚ç¸½è¨ˆï¼š$0</p>
            <button id="continue-btn" onclick="continueOrdering()">ç¹¼çºŒé»é¤</button> 
        </div>
    </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
      // âœ… Public Key å·²æ›´æ–°ç‚º 9IpHY4bm1ftOnH-TB
      (function() {
        emailjs.init("9IpHY4bm1ftOnH-TB"); 
      })();
    </script>
    
    <script>
        const cart = {};
        let total = 0; 

        // èœå–®è³‡æ–™ (ç•¥)
        const categories = {
            'äººæ°£æ–™ç†æ¨è–¦': [
                ['kimchi.jpg', 'æ³¡èœé‹', 'é…¸è¾£æ¿ƒéƒï¼Œæš–èƒƒå¿…åƒï¼', 250],
                ['bibimbap.jpg', 'çŸ³é‹æ‹Œé£¯', 'æ–°é®®è”¬èœèˆ‡é¦™æ¿ƒæ‹Œé†¬çš„å®Œç¾çµåˆã€‚', 220],
                ['tteokbokk.jpg', 'è¾£ç‚’å¹´ç³•', 'ç”œè¾£å£æ„Ÿï¼Œè®“äººå›å‘³ç„¡çª®ã€‚', 180],
                ['soondubu.jpg', 'éŸ“å¼è±†è…é‹', 'æ¿ƒéƒæ¹¯åº•ï¼Œæº«æš–äººå¿ƒçš„å®¶å¸¸å¥½å‘³é“ã€‚', 230],
                ['kor_budaejjigae_main.jpg', 'éŸ“å¼éƒ¨éšŠé‹', 'é¦™æ¿ƒéŸ“å¼ç«é‹ï¼Œæ»¿æ»¿ç†±é¨°é¨°æ–™ã€‚', 280],
                ['seafood_hotpot_kor.jpg', 'éŸ“å¼æµ·é®®é‹', 'é®®ç¾æµ·é®®æ¹¯ï¼Œç›¡äº«å¤§æµ·æ»‹å‘³ã€‚', 260],
                ['kor_blackbean_noodle.jpg', 'éŸ“å¼ç‚¸é†¬éºµ', 'æ¿ƒéƒé»‘é†¬éºµï¼Œå®Œç¾èåˆç”œé¹¹ã€‚', 190],
                ['korean_gimbap.jpg', 'éŸ“å¼é£¯æ²', 'æ¿ƒéƒæ¹¯åº•ï¼Œæº«æš–äººå¿ƒçš„å®¶å¸¸å¥½å‘³é“ã€‚', 160]
            ],
            'é…èœ': [
                ['kimchi_pancake.jpg', 'æ³¡èœç…é¤…', 'é…¸è¾£çˆ½å£ï¼Œé¦™è„†å¯å£çš„ç¶“å…¸éŸ“å¼ç…é¤…ã€‚', 200],
                ['seafood_pancake.jpg', 'æµ·é®®ç…é¤…', 'æ»¿æ»¿æµ·å‘³ï¼Œå¤–é…¥å…§å«©çš„éŸ“å¼ç¾å‘³ã€‚', 220],
                ['yangnyeom_chicken.jpg', 'éŸ“å¼æ´‹é‡€ç‚¸é›', 'ç”œè¾£é†¬æ±è£¹æ»¿ï¼Œæ¯å£éƒ½é¦™æ¿ƒéç™®ã€‚', 240],
                ['honey_chicken.jpg', 'éŸ“å¼èœ‚èœœç‚¸é›', 'æ¿ƒéƒèœ‚èœœé¦™ï¼Œç”œæ»‹æ»‹çš„ç‚¸é›äº«å—ã€‚', 240]
            ],
            'é£²æ–™': [
                ['yuzu_tea.jpg', 'éŸ“å¼æŸšå­èŒ¶', 'æ¸…æ–°ç”˜ç”œï¼Œå¸¶æœ‰æŸšå­çš„é¦™æ°£èˆ‡æœè‚‰ã€‚', 90],
                ['strawberry_milk.jpg', 'è‰è“ç‰›å¥¶', 'ç”œç¾è‰è“èå…¥æ¿ƒé†‡ç‰›å¥¶ï¼Œé¦™æ¿ƒå¯å£ã€‚', 80],
                ['banana_milk.jpg', 'é¦™è•‰ç‰›å¥¶', 'éŸ“åœ‹ç¶“å…¸ï¼Œæ¿ƒéƒé¦™ç”œçš„é¦™è•‰é¢¨å‘³ã€‚', 80],
                ['calpis_drink.jpg', 'å¯çˆ¾å¿…æ€', 'é…¸ç”œæ¸…çˆ½ï¼Œæœ€å…·äººæ°£çš„éŸ“å¼é£²å“ã€‚', 70]
            ],
            'ç”œé»': [
                ['yuzu_mochi.jpg', 'éŸ“å¼æŸšå­å¤§ç¦', 'æŸšé¦™æ¿ƒéƒï¼ŒQå½ˆå¤–çš®åŒ…è£¹æœé¦™æ»¿æº¢çš„å…§é¤¡ã€‚', 100],
                ['dalgona_ice_cream.jpg', 'éŸ“å¼æ¤ªç³–éœœæ·‡æ·‹', 'ç¶“å…¸æ¤ªç³–æ­é…æ¿ƒæ»‘éœœæ·‡æ·‹ï¼Œé…¥è„†èˆ‡ç¶¿å¯†çš„çµ•å¦™çµåˆã€‚', 120],
                ['flat_croissant.jpg', 'éŸ“å¼æ‰å¯é Œ', 'å£“æ‰é€ å‹æ›´é…¥è„†ï¼Œå±¤æ¬¡åˆ†æ˜çš„éŸ“å¼æ–°æ½®ç”œé»ã€‚', 150],
                ['bento_cake.jpg', 'éŸ“å¼ä¾¿ç•¶å°è›‹ç³•', 'è¿·ä½ è›‹ç³•å¤–å‹å¯æ„›ï¼Œç”œè€Œä¸è†©ï¼Œç²¾ç·»ä¾¿ç•¶å¼äº«å—ã€‚', 130]
            ]
        };

        // æ¸²æŸ“èœå–®çš„å‡½å¼ (ç•¥)
        function renderMenu() {
            const menuList = document.getElementById('menu-list');
            menuList.innerHTML = ''; 

            for (const category in categories) {
                const h2 = document.createElement('h2');
                h2.textContent = `ğŸ´ ${category}`;
                menuList.appendChild(h2);

                const menuContainer = document.createElement('div');
                menuContainer.className = 'menu';

                categories[category].forEach(dish => {
                    const [image, name, description, price] = dish;
                    
                    const dishElement = document.createElement('div');
                    dishElement.className = 'dish';
                    dishElement.innerHTML = `
                        <img src="${image}" alt="${name}" onerror="this.onerror=null; this.src='https://via.placeholder.com/200?text=${name}'">
                        <h3>${name}</h3>
                        <p>${description}</p>
                        <p>åƒ¹æ ¼ï¼š$${price}</p>
                        <button onclick="addToCart('${name}', ${price}); event.stopPropagation();">åŠ å…¥è³¼ç‰©è»Š</button>
                    `;
                    menuContainer.appendChild(dishElement);
                });

                menuList.appendChild(menuContainer);
            }
        }

        // åŠ å…¥è³¼ç‰©è»Šå‡½å¼ (ç•¥)
        function addToCart(name, price) {
            if (cart[name]) {
                cart[name].qty++;
            } else {
                cart[name] = { price: price, qty: 1 };
            }
            updateCartDisplay();
        }

        // ç§»é™¤è³¼ç‰©è»Šå“é …çš„å‡½å¼ (ç•¥)
        function removeFromCart(name) {
            if (cart[name]) {
                delete cart[name]; 
                updateCartDisplay(); 
            }
        }

        // æ¸›å°‘è³¼ç‰©è»Šæ•¸é‡å‡½å¼ (ç•¥)
        function decreaseQuantity(name) {
            if (cart[name] && cart[name].qty > 1) {
                cart[name].qty--;
            } else if (cart[name] && cart[name].qty === 1) {
                delete cart[name]; 
            }
            updateCartDisplay();
        }
        
        // æ›´æ–°è³¼ç‰©è»Šé¡¯ç¤ºå‡½å¼ (ç•¥)
        function updateCartDisplay() {
            const cartList = document.getElementById('cart-list');
            const totalElement = document.getElementById('total');
            const summaryText = document.getElementById('cart-summary-text');
            total = 0; 
            cartList.innerHTML = '';

            for (const name in cart) {
                const item = cart[name];
                const itemTotal = item.price * item.qty;
                total += itemTotal;

                const li = document.createElement('li');
                li.innerHTML = `
                    <span>${name} x ${item.qty}</span>
                    <span>$${itemTotal}</span>
                    <button style="margin-left: 10px; padding: 3px 6px; background-color: #b22222; color: white; border: none; border-radius: 3px; cursor: pointer;" 
                            onclick="decreaseQuantity('${name}'); event.stopPropagation();">ï¼</button>
                    <span style="margin-left: 10px; cursor: pointer; color: #b22222;" 
                          onclick="removeFromCart('${name}'); event.stopPropagation();" title="ç§»é™¤æ‰€æœ‰ ${name}">âŒ</span>
                `;
                cartList.appendChild(li);
            }

            totalElement.textContent = `ç¸½è¨ˆï¼š$${total}`;
            // æ›´æ–° Bar ä¸Šçš„å³æ™‚ç¸½è¨ˆ
            summaryText.textContent = total > 0 ? ` (ç¸½è¨ˆï¼š$${total})` : ` (ç¸½è¨ˆï¼š$0)`;
        }

        // åˆ‡æ›è³¼ç‰©è»Šå±•é–‹/æ”¶åˆ (ç•¥)
        function toggleCart() {
            const cartElement = document.getElementById('cart');
            cartElement.classList.toggle('expanded');
        }

        // è¼”åŠ©å‡½å¼ï¼šé¡¯ç¤ºçµå¸³æˆåŠŸ Modal (å·²æ›´æ–°ï¼Œæ¥æ”¶å§“åå’Œå‚™è¨»)
        function displayCheckoutModal(sum, customerName, remarks) {
            const modal = document.getElementById('checkout-modal');
            const summaryList = document.getElementById('order-summary');
            const totalDisplay = document.getElementById('order-total');
            const infoDiv = document.getElementById('modal-customer-info'); // å–å¾—é¡§å®¢è³‡è¨Šé¡¯ç¤ºå€

            summaryList.innerHTML = ''; 
            
            // é¡¯ç¤ºé¡§å®¢å§“åå’Œå‚™è¨»
            infoDiv.innerHTML = `
                <p><strong>é¡§å®¢å§“å:</strong> ${customerName}</p>
                <p><strong>è¨‚å–®å‚™è¨»:</strong> ${remarks || 'ç„¡'}</p>
                <hr style="margin-top: 15px;">
            `;

            // éæ­·è³¼ç‰©è»Šï¼Œå‰µå»ºç²¾ç·»åŒ–åˆ—è¡¨
            for (const [name, item] of Object.entries(cart)) {
                const itemTotal = item.price * item.qty;
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="item-name">${name} (x${item.qty})</span>
                    <span class="item-price">$${itemTotal}</span>
                `;
                summaryList.appendChild(li);
            }

            totalDisplay.textContent = `æœ€çµ‚ç¸½è¨ˆï¼š$${sum}`;

            modal.style.display = 'flex';
        }

        // æ ¸å¿ƒå‡½å¼ï¼šçµå¸³èˆ‡ç™¼é€ Email (å·²æ›´æ–°ï¼ŒåŒ…å«å§“åå’Œå‚™è¨»)
        function checkout() {
            const customerName = document.getElementById('customer-name').value.trim();
            const remarks = document.getElementById('order-remarks').value.trim();
            
            // 1. é©—è­‰
            if (total === 0) {
                alert('è«‹å…ˆé¸æ“‡é¤é»');
                return;
            }
            if (!customerName) {
                alert('è«‹è¼¸å…¥æ‚¨çš„å§“åä»¥å®Œæˆè¨‚è³¼');
                return;
            }

            let orderDetailsText = ''; 
            let sum = total; 

            for (const [name, item] of Object.entries(cart)) {
                const itemTotal = item.price * item.qty;
                orderDetailsText += `${name} x ${item.qty} = $${itemTotal}\n`;
            }
            
            // å°‡å§“åå’Œå‚™è¨»ä¹ŸåŠ å…¥åˆ°éƒµä»¶å…§å®¹ä¸­
            orderDetailsText += `--- é¡§å®¢è³‡è¨Š ---\n`;
            orderDetailsText += `é¡§å®¢å§“å: ${customerName}\n`;
            orderDetailsText += `è¨‚å–®å‚™è¨»: ${remarks || 'ç„¡å‚™è¨»'}\n`;

            // --- EmailJS ç™¼é€éƒµä»¶é‚è¼¯ ---
            const templateParams = {
                order_details: orderDetailsText, 
                total_amount: sum, 
                shop_email: 'anita.chen0201@gmail.com', 
                order_time: new Date().toLocaleString('zh-TW'),
                // é¡å¤–å‚³éå§“åå’Œå‚™è¨» (å¦‚æœæ‚¨çš„ Email æ¨¡æ¿æœ‰å°ˆé–€çš„æ¬„ä½ï¼Œé€™æœƒæ›´æœ‰ç”¨)
                customer_name: customerName,
                customer_remarks: remarks || 'ç„¡å‚™è¨»'
            };

            // ä½¿ç”¨æ‚¨æä¾›çš„ Service ID å’Œ Template ID
            emailjs.send('service_ezl82r4', 'template_qa3uc6r', templateParams)
                .then(() => {
                   // å‚³éå§“åå’Œå‚™è¨»çµ¦ Modal é¡¯ç¤º
                   displayCheckoutModal(sum, customerName, remarks); 
                }, (error) => {
                   console.error('è¨‚å–®éƒµä»¶ç™¼é€å¤±æ•—:', error);
                   // å³ä½¿ç™¼é€å¤±æ•—ï¼Œä¹Ÿå…ˆé¡¯ç¤º Modal è®“ä½¿ç”¨è€…çŸ¥é“è¨‚å–®è³‡è¨Š
                   displayCheckoutModal(sum, customerName, remarks); 
                   alert('ç³»çµ±ç™¼ç”ŸéŒ¯èª¤ï¼Œè¨‚å–®éƒµä»¶å¯èƒ½ç™¼é€å¤±æ•—ï¼Œè«‹æ‰‹å‹•ç¢ºèªã€‚');
                });
        }

        // ç¹¼çºŒé»é¤ï¼ˆé—œé–‰ Modal ä¸¦æ¸…ç©ºè³¼ç‰©è»Šï¼‰(å·²æ›´æ–°ï¼šæ¸…ç©ºå‚™è¨»æ¬„ä½)
        function continueOrdering() {
            document.getElementById('checkout-modal').style.display = 'none';
            // æ¸…ç©ºè³¼ç‰©è»Š
            for (const key in cart) {
                delete cart[key];
            }
            // æ¸…ç©ºå§“åå’Œå‚™è¨»æ¬„ä½
            document.getElementById('customer-name').value = '';
            document.getElementById('order-remarks').value = '';

            updateCartDisplay();
            window.scrollTo(0, 0); 
        }

        // ç¶²é åŠ è¼‰æ™‚åŸ·è¡Œ (ç•¥)
        window.onload = function() {
            renderMenu();
        };

    </script>
</body>
</html>


